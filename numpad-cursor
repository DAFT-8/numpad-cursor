#!/bin/bash

command -v sxhkd > /dev/null 2>&1 || {
    echo >&2 "sxhkd is not installed. Aborting.";
    exit 1;
}

xset r rate 200 50

SPEED_FILE="/tmp/numpad-cursor-speed"
echo 10 > "$SPEED_FILE"

CONFIG_DIR="$HOME/.config/sxhkd"
CONFIG_FILE="$CONFIG_DIR/sxhkdrc"
mkdir -p "$CONFIG_DIR"

cat > "$CONFIG_FILE" <<EOF
KP_Up
    xdotool mousemove_relative -- 0 -\$(cat $SPEED_FILE)
KP_Up + alt
    xdotool mousemove_relative -- 0 -3

KP_Down
    xdotool mousemove_relative -- 0 \$(cat $SPEED_FILE)
KP_Down + alt
    xdotool mousemove_relative -- 0 3

KP_Left
    xdotool mousemove_relative -- -\$(cat $SPEED_FILE) 0
KP_Left + alt
    xdotool mousemove_relative -- -3 0

KP_Right
    xdotool mousemove_relative -- \$(cat $SPEED_FILE) 0
KP_Right + alt
    xdotool mousemove_relative -- 3 0

KP_7
    xdotool mousemove_relative -- -\$(cat $SPEED_FILE) -\$(cat $SPEED_FILE)
KP_7 + alt
    xdotool mousemove_relative -- -3 -3
KP_Home
    xdotool mousemove_relative -- -\$(cat $SPEED_FILE) -\$(cat $SPEED_FILE)
KP_Home + alt
    xdotool mousemove_relative -- -3 -3

KP_1
    xdotool mousemove_relative -- -\$(cat $SPEED_FILE) \$(cat $SPEED_FILE)
KP_1 + alt
    xdotool mousemove_relative -- -3 3
KP_End
    xdotool mousemove_relative -- -\$(cat $SPEED_FILE) \$(cat $SPEED_FILE)
KP_End + alt
    xdotool mousemove_relative -- -3 3

KP_3
    xdotool mousemove_relative -- \$(cat $SPEED_FILE) \$(cat $SPEED_FILE)
KP_3 + alt
    xdotool mousemove_relative -- 3 3
KP_Next
    xdotool mousemove_relative -- \$(cat $SPEED_FILE) \$(cat $SPEED_FILE)
KP_Next + alt
    xdotool mousemove_relative -- 3 3

KP_9
    xdotool mousemove_relative -- \$(cat $SPEED_FILE) -\$(cat $SPEED_FILE)
KP_9 + alt
    xdotool mousemove_relative -- 3 -3
KP_Prior
    xdotool mousemove_relative -- \$(cat $SPEED_FILE) -\$(cat $SPEED_FILE)
KP_Prior + alt
    xdotool mousemove_relative -- 3 -3

KP_Insert
    xdotool click 1
KP_0
    xdotool click 1

KP_Enter
    xdotool click 3

KP_5
    xdotool click 2
KP_Begin
    xdotool click 2

KP_Multiply
    echo \$((\$(cat $SPEED_FILE) * 2)) > $SPEED_FILE
KP_Divide
    echo \$((\$(cat $SPEED_FILE) / 2 + 1)) > $SPEED_FILE

KP_Add
    xdotool click --clearmodifiers 5
KP_Subtract
    xdotool click --clearmodifiers 4
EOF

sxhkd -c "$CONFIG_FILE"

xset r rate 500 10
